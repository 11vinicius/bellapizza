<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bella Massa - Card√°pio Digital</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="icon" type="image/png" href="./bellamassa.png">

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#922521',
                        brandBg: '#fef5e6',
                    }
                }
            }
        }
    </script>
    <style type="text/tailwindcss">
        @layer components {
            .btn-tab { @apply flex-1 py-4 text-white font-bold transition-all border-b-4 border-transparent; }
            .btn-tab.active { @apply bg-white/20 border-white; }
            .modal-container { @apply fixed inset-0 bg-black/70 z-[1000] flex items-center justify-center hidden p-4; }
            .modal-content-center { 
                @apply bg-brandBg w-full max-w-md p-6 rounded-[2rem] max-h-[90vh] overflow-y-auto shadow-2xl animate-[popIn_0.2s_ease-out];
                scrollbar-width: none; 
                -ms-overflow-style: none; 
            }
            .modal-content-center::-webkit-scrollbar { display: none; }
            .flavor-card { @apply bg-white border-2 border-transparent p-4 rounded-xl text-center cursor-pointer shadow-sm font-semibold transition-all; }
            .flavor-card.selected { @apply border-primary bg-[#fde8e7] text-primary; }
            .modal-alert-content { @apply bg-white rounded-3xl p-8 w-full max-w-xs text-center shadow-2xl animate-[popIn_0.2s_ease-out]; }
        }
        @keyframes popIn { from { transform: scale(0.9); opacity: 0; } to { transform: scale(1); opacity: 1; } }
    </style>
</head>

<body class="bg-brandBg text-gray-800 pb-24">

    <div id="alertModal" class="modal-container" style="z-index: 3000;" onclick="closeAlert()">
        <div class="modal-alert-content" onclick="event.stopPropagation()">
            <div id="alertIcon" class="text-6xl mb-4"></div>
            <h3 id="alertTitle" class="text-2xl font-bold text-gray-800 mb-2"></h3>
            <p id="alertMessage" class="text-gray-600 mb-8 leading-relaxed"></p>
            <div id="alertButtons" class="space-y-2">
                <button id="alertBtnPrimary" onclick="closeAlert()"
                    class="w-full bg-primary text-white py-4 rounded-2xl font-bold uppercase shadow-lg active:scale-95">Entendido</button>
                <button id="alertBtnCart" onclick="showCart(); closeAlert();"
                    class="w-full bg-green-600 text-white py-4 rounded-2xl font-bold uppercase shadow-lg active:scale-95 hidden">Ver
                    Carrinho</button>
            </div>
        </div>
    </div>

    <header class="bg-white flex justify-between items-center shadow-md px-6 py-2">
        <img src="./bellamassa.png" alt="Bella Massa" class="w-[120px]">
        <div class="relative cursor-pointer" onclick="showCart()">
            <i class="fas fa-shopping-cart text-primary text-2xl"></i>
            <span id="cartBadge"
                class="absolute -top-2 -right-2 bg-green-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center hidden font-bold">0</span>
        </div>
    </header>

    <nav class="tabs flex bg-primary sticky top-0 z-50 shadow-lg font-sans">
        <button id="btn-pizzas" class="btn-tab active uppercase text-[14px] tracking-tighter"
            onclick="openTab('pizzas')">Pizzas Salgadas</button>
        <button id="btn-doces" class="btn-tab uppercase text-[14px] tracking-tighter" onclick="openTab('doces')">Pizzas
            Doces</button>
        <button id="btn-bebidas" class="btn-tab uppercase text-[14px] tracking-tighter"
            onclick="openTab('bebidas')">Bebidas</button>
    </nav>

    <main class="container max-w-xl mx-auto p-4">
        <div id="pizzas" class="category-section block space-y-4"></div>
        <div id="doces" class="category-section hidden space-y-4"></div>
        <div id="bebidas" class="category-section hidden space-y-4"></div>
    </main>

    <div id="selectionModal" class="modal-container" onclick="handleOutsideClick(event)">
        <div class="modal-content-center">
            <div id="step1">
                <div class="flex justify-between items-center mb-4">
                    <h2 id="modalTitle" class="text-xl font-bold text-primary italic">Sabores</h2>
                    <span id="stepBadge"
                        class="bg-primary/10 text-primary px-3 py-1 rounded-full text-[10px] font-bold">PASSO 1/2</span>
                </div>
                <p id="modalSubtitle" class="text-xs text-gray-500 mb-4 text-center font-bold">Selecione os sabores</p>
                <div id="flavorContainer" class="space-y-2 mb-6"></div>
                <div class="flex gap-2">
                    <button class="flex-1 bg-gray-200 text-gray-500 py-3 rounded-xl font-bold uppercase text-xs"
                        onclick="closeModal('selectionModal')">Sair</button>
                    <button class="flex-1 bg-primary text-white py-3 rounded-xl font-bold uppercase text-xs shadow-md"
                        onclick="goToStep(2)">Pr√≥ximo</button>
                </div>
            </div>
            <div id="step2" class="hidden">
                <div class="flex justify-between items-center mb-4">
                    <h2 class="text-xl font-bold text-primary italic">Borda</h2>
                    <span class="bg-primary/10 text-primary px-3 py-1 rounded-full text-[10px] font-bold">PASSO
                        2/2</span>
                </div>
                <div id="bordaContainer" class="grid grid-cols-1 gap-2 mb-6">
                    <div class="flavor-card borda-opt" onclick="selectBorda(this, 'Sem Borda')">Sem Borda</div>
                    <div class="flavor-card borda-opt" onclick="selectBorda(this, 'Catupiry')">Catupiry</div>
                    <div class="flavor-card borda-opt" onclick="selectBorda(this, 'Cheddar')">Cheddar</div>
                </div>
                <div class="flex gap-2">
                    <button
                        class="flex-1 bg-white border border-gray-200 text-gray-400 py-3 rounded-xl font-bold uppercase text-xs"
                        onclick="goToStep(1)">Voltar</button>
                    <button class="flex-1 bg-primary text-white py-3 rounded-xl font-bold uppercase text-xs shadow-md"
                        onclick="confirmSelection()">Concluir</button>
                </div>
            </div>
        </div>
    </div>

    <div id="cartModal" class="modal-container" onclick="handleOutsideClick(event)">
        <div class="modal-content-center">
            <div id="cartStep1">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-2xl font-bold text-primary italic">Seu Pedido</h2>
                    <button onclick="closeModal('cartModal')" class="text-gray-400"><i
                            class="fas fa-times text-xl"></i></button>
                </div>
                <div id="cartList" class="space-y-3 mb-6"></div>
                <div id="cartActions" class="flex gap-2 hidden">
                    <button class="flex-1 bg-gray-200 text-gray-500 py-4 rounded-2xl font-bold uppercase text-xs"
                        onclick="closeModal('cartModal')">Comprar +</button>
                    <button id="btnNextCart"
                        class="flex-1 bg-primary text-white py-4 rounded-2xl font-bold uppercase text-xs shadow-lg"
                        onclick="switchCartStep(2)">Finalizar</button>
                </div>
                <div id="emptyCartMsg" class="text-center py-10 hidden">
                    <i class="fas fa-shopping-basket text-gray-300 text-5xl mb-4"></i>
                    <p class="text-gray-400 font-semibold mb-6">Seu carrinho est√° vazio</p>
                </div>
            </div>

            <div id="cartStep2" class="hidden">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-2xl font-bold text-primary italic">Finalizar</h2>
                    <button onclick="switchCartStep(1)" class="text-gray-400"><i
                            class="fas fa-arrow-left text-xl"></i></button>
                </div>
                <div class="space-y-3 bg-white p-4 rounded-3xl border border-gray-100 shadow-inner mb-6">
                    <input type="text" id="nome" placeholder="Seu Nome"
                        class="w-full p-4 rounded-xl border border-gray-100 bg-gray-50 outline-primary text-sm">
                    <input type="tel" id="celular" placeholder="Seu Celular (Ex: (65) 99999-9999)"
                        class="w-full p-4 rounded-xl border border-gray-100 bg-gray-50 outline-primary text-sm"
                        oninput="maskCelular(this)" maxlength="15">
                    <input type="text" id="endereco" placeholder="Endere√ßo Completo"
                        class="w-full p-4 rounded-xl border border-gray-100 bg-gray-50 outline-primary text-sm">
                    <select id="pagamento"
                        class="w-full p-4 rounded-xl border border-gray-100 bg-gray-50 outline-primary text-sm">
                        <option value="" disabled selected>Forma de Pagamento</option>
                        <option value="Pix">Pix</option>
                        <option value="Cart√£o">Cart√£o</option>
                        <option value="Dinheiro">Dinheiro</option>
                    </select>
                    <textarea id="obs" placeholder="Alguma observa√ß√£o?"
                        class="w-full p-4 rounded-xl border border-gray-100 bg-gray-50 outline-primary text-sm h-20"></textarea>
                </div>
                <button
                    class="w-full bg-green-600 text-white py-4 rounded-2xl font-bold uppercase flex items-center justify-center gap-3 shadow-lg active:scale-95"
                    onclick="sendWhatsApp()">
                    <i class="fab fa-whatsapp text-xl"></i> Enviar Pedido
                </button>
            </div>
        </div>
    </div>

    <div class="fixed bottom-6 left-1/2 -translate-x-1/2 w-[92%] max-w-md bg-primary text-white p-4 rounded-[2rem] flex justify-between items-center font-bold shadow-2xl z-40 cursor-pointer active:scale-95 transition-transform"
        onclick="showCart()">
        <span class="flex items-center gap-2 uppercase text-xs tracking-wider ml-2"><i class="fas fa-shopping-bag"></i>
            Carrinho</span>
        <span id="totalDisplay" class="bg-white text-primary px-5 py-2 rounded-full font-black text-lg font-sans">R$
            0,00</span>
    </div>

    <script>
        const listaPizzas = [
            { id: 1, nome: "Combo 3 Pizzas", desc: "Escolha at√© 3 sabores", preco: 99.90, max: 3, borda: true },
            { id: 2, nome: "Combo 2 Pizzas", desc: "Escolha at√© 2 sabores", preco: 79.90, max: 2, borda: true },
            { id: 5, nome: "Pizza Tradicional", desc: "Pizza Inteira Salgada", preco: 55.90, max: 2, borda: true }
        ];

        const listaDoces = [
            { id: 201, nome: "Pizza Chocolate", desc: "Chocolate ao leite", preco: 45.90 },
            { id: 202, nome: "Pizza Prest√≠gio", desc: "Chocolate com coco", preco: 45.90 },
            { id: 203, nome: "Pizza Romeu e Julieta", desc: "Queijo com goiabada", preco: 45.90 },
            { id: 204, nome: "Pizza Banana c/ Canela", desc: "Banana e a√ß√∫car", preco: 45.90 }
        ];

        const listaBebidas = [
            { id: 101, nome: "Coca-Cola 2L", desc: "Geladinha", preco: 14.00 },
            { id: 102, nome: "Guaran√° 2L", desc: "Antarctica", preco: 12.00 },
            { id: 104, nome: "Coca-Cola Lata", desc: "350ml", preco: 6.00 },
        ];

        const saboresSalgados = [
            { nome: "Mussarela", desc: "Molho de tomate, mussarela e or√©gano" },
            { nome: "Calabresa", desc: "Molho de tomate, mussarela, calabresa fatiada, cebola e or√©gano" },
            { nome: "Presunto e Mussarela", desc: "Molho de tomate, mussarela e presunto" },
            { nome: "Frango com Catupiry", desc: "Molho de tomate, mussarela, frango desfiado temperado e requeij√£o tipo catupiry" },
            { nome: "Portuguesa", desc: "Molho de tomate, mussarela, presunto, ovo, cebola e azeitona" },
            { nome: "Quatro Queijos", desc: "Molho de tomate, mussarela, requeij√£o, parmes√£o ralado e provolone" },
            { nome: "Bacon", desc: "Molho de tomate, mussarela e bacon em cubos crocante" },
            { nome: "Moda da Casa", desc: "Molho de tomate, mussarela, calabresa, bacon e cebola" }
        ];


        let cart = [];
        let currentTask = { max: 0, name: '', price: 0, selectedBorda: 'Sem Borda', hasBorda: true };
        let flavorSelections = {};

        function renderMenu() {
            document.getElementById('pizzas').innerHTML = listaPizzas.map(p => `
                <div class="product-card bg-white p-4 rounded-xl flex justify-between items-center shadow-sm">
                    <div>
                        <h3 class="font-bold text-primary text-lg">${p.nome}</h3>
                        <p class="text-sm text-gray-500 italic">${p.desc}</p>
                        <span class="font-bold text-xl text-primary font-sans">R$ ${p.preco.toFixed(2).replace('.', ',')}</span>
                    </div>
                    <button class="bg-primary text-white w-12 h-12 rounded-full text-2xl flex items-center justify-center shadow-lg font-bold"
                        onclick="openSelectionModal(${p.max}, '${p.nome}', ${p.preco}, ${p.borda})">+</button>
                </div>`).join('');

            document.getElementById('doces').innerHTML = listaDoces.map(d => `
                <div class="product-card bg-white p-4 rounded-xl flex justify-between items-center shadow-sm">
                    <div>
                        <h3 class="font-bold text-primary text-lg">${d.nome}</h3>
                        <p class="text-sm text-gray-500 italic">${d.desc}</p>
                        <span class="font-bold text-xl text-primary font-sans">R$ ${d.preco.toFixed(2).replace('.', ',')}</span>
                    </div>
                    <button class="bg-primary text-white w-12 h-12 rounded-full text-2xl flex items-center justify-center shadow-lg active:scale-90 font-bold"
                        onclick="addToCart('${d.nome}', ${d.preco})">+</button>
                </div>`).join('');

            document.getElementById('bebidas').innerHTML = listaBebidas.map(b => `
                <div class="product-card bg-white p-4 rounded-xl flex justify-between items-center shadow-sm">
                    <div>
                        <h3 class="font-bold text-primary text-lg">${b.nome}</h3>
                        <p class="text-sm text-gray-500 italic">${b.desc}</p>
                        <span class="font-bold text-xl text-primary font-sans">R$ ${b.preco.toFixed(2).replace('.', ',')}</span>
                    </div>
                    <button class="bg-primary text-white w-12 h-12 rounded-full text-2xl flex items-center justify-center shadow-lg active:scale-90 font-bold"
                        onclick="addToCart('${b.nome}', ${b.preco})">+</button>
                </div>`).join('');
        }

        function openTab(id) {
            document.querySelectorAll('.category-section').forEach(s => s.classList.add('hidden'));
            document.querySelectorAll('.btn-tab').forEach(b => b.classList.remove('active'));
            document.getElementById(id).classList.remove('hidden');
            document.getElementById('btn-' + id).classList.add('active');
        }

        function openSelectionModal(max, name, price, hasBorda) {
            currentTask = { max, name, price, selectedBorda: 'Sem Borda', hasBorda };
            flavorSelections = {};
            saboresSalgados.forEach(s => flavorSelections[s.nome] = 0);
            document.getElementById('modalTitle').innerText = name;
            document.getElementById('stepBadge').innerText = "PASSO 1/2";
            renderFlavorSteps();
            goToStep(1);
            document.getElementById('selectionModal').classList.remove('hidden');
            document.getElementById('selectionModal').classList.add('flex');
        }

        function renderFlavorSteps() {
            document.getElementById('flavorContainer').innerHTML = saboresSalgados.map(s => `
                <div class="flex items-center justify-between bg-white p-3 rounded-xl border border-gray-100 shadow-sm">
                    <div class="flex-1 pr-2">
                        <span class="font-bold text-gray-700 text-sm font-sans block">${s.nome}</span>
                        <small class="text-[14px] text-gray-400 leading-tight block">${s.desc}</small>
                    </div>
                    <div class="flex items-center gap-3 bg-gray-50 rounded-full px-2 py-1">
                        <button onclick="changeFlavorQty('${s.nome}', -1)" class="w-8 h-8 bg-white rounded-full shadow text-primary font-black text-lg">-</button>
                        <span id="qty-${s.nome}" class="font-bold min-w-[15px] text-center text-sm font-sans">0</span>
                        <button onclick="changeFlavorQty('${s.nome}', 1)" class="w-8 h-8 bg-white rounded-full shadow text-primary font-black text-lg">+</button>
                    </div>
                </div>`).join('');
        }

        function changeFlavorQty(sabor, delta) {
            const totalSelected = Object.values(flavorSelections).reduce((a, b) => a + b, 0);
            if (delta > 0 && totalSelected >= currentTask.max) return showAlert(`Limite de ${currentTask.max} sabores atingido.`);
            if (delta < 0 && flavorSelections[sabor] <= 0) return;
            flavorSelections[sabor] += delta;
            document.getElementById(`qty-${sabor}`).innerText = flavorSelections[sabor];
            document.getElementById('modalSubtitle').innerText = `Selecionado: ${totalSelected + delta} de ${currentTask.max}`;
        }

        function goToStep(step) {
            if (step === 2) {
                const total = Object.values(flavorSelections).reduce((a, b) => a + b, 0);
                if (total !== currentTask.max) return showAlert(`Por favor, selecione os ${currentTask.max} sabores.`);
                document.getElementById('step1').classList.add('hidden');
                document.getElementById('step2').classList.remove('hidden');
            } else {
                document.getElementById('step1').classList.remove('hidden');
                document.getElementById('step2').classList.add('hidden');
            }
        }

        function selectBorda(element, borda) {
            document.querySelectorAll('.borda-opt').forEach(el => el.classList.remove('selected'));
            element.classList.add('selected');
            currentTask.selectedBorda = borda;
        }

        function confirmSelection() {
            const flavorsArray = [];
            for (const [sabor, qtd] of Object.entries(flavorSelections)) { if (qtd > 0) flavorsArray.push(`${qtd}x ${sabor}`); }
            cart.push({ nome: `${currentTask.name} (${flavorsArray.join(' + ')})`, borda: currentTask.selectedBorda, preco: currentTask.price });
            updateUI();
            closeModal('selectionModal');
            showAlert('Produto adicionado ao carrinho!', 'success');
        }

        function addToCart(name, price) {
            cart.push({ nome: name, preco: price, borda: '' });
            updateUI();
            showAlert('Produto adicionado ao carrinho!', 'success');
        }

        function updateUI() {
            const total = cart.reduce((acc, item) => acc + item.preco, 0);
            document.getElementById('totalDisplay').innerText = `R$ ${total.toFixed(2).replace('.', ',')}`;
            const badge = document.getElementById('cartBadge');
            badge.innerText = cart.length;
            cart.length > 0 ? badge.classList.remove('hidden') : badge.classList.add('hidden');
        }

        function switchCartStep(step) {
            if (step === 2 && cart.length === 0) return;
            document.getElementById('cartStep1').classList.toggle('hidden', step === 2);
            document.getElementById('cartStep2').classList.toggle('hidden', step === 1);
        }

        function showCart() {
            const list = document.getElementById('cartList');
            const actions = document.getElementById('cartActions');
            const emptyMsg = document.getElementById('emptyCartMsg');
            switchCartStep(1);
            if (cart.length === 0) {
                list.innerHTML = "";
                actions.classList.add('hidden');
                emptyMsg.classList.remove('hidden');
            } else {
                emptyMsg.classList.add('hidden');
                actions.classList.remove('hidden');
                list.innerHTML = cart.map((item, i) => `
                <div class="flex justify-between items-center bg-white p-4 rounded-2xl border border-gray-100 shadow-sm">
                    <div><b class="text-primary text-sm uppercase block">${item.nome}</b>
                    ${item.borda ? `<small class="text-gray-400 font-bold text-[10px]">Borda: ${item.borda}</small>` : ''}</div>
                    <div class="text-right ml-4"><b class="block text-primary text-sm font-sans">R$ ${item.preco.toFixed(2).replace('.', ',')}</b>
                    <button onclick="removeItem(${i})" class="text-red-400 text-[10px] font-black uppercase">Remover</button></div>
                </div>`).join('');
            }
            document.getElementById('cartModal').classList.remove('hidden');
            document.getElementById('cartModal').classList.add('flex');
        }

        function removeItem(i) { cart.splice(i, 1); updateUI(); showCart(); }
        function closeModal(id) { document.getElementById(id).classList.add('hidden'); }
        function handleOutsideClick(event) { if (event.target.classList.contains('modal-container')) closeModal(event.target.id); }

        function showAlert(message, type = 'error') {
            document.getElementById('alertIcon').innerHTML = type === 'success' ? '‚ú®' : 'üîî';
            document.getElementById('alertTitle').innerText = type === 'success' ? 'Sucesso!' : 'Aten√ß√£o';
            document.getElementById('alertMessage').innerText = message;
            const btnPrimary = document.getElementById('alertBtnPrimary');
            const btnCart = document.getElementById('alertBtnCart');
            if (type === 'success') {
                btnPrimary.innerText = "Continuar";
                btnCart.classList.remove('hidden');
            } else {
                btnPrimary.innerText = "Entendido";
                btnCart.classList.add('hidden');
            }
            document.getElementById('alertModal').classList.remove('hidden');
            document.getElementById('alertModal').classList.add('flex');
        }
        function closeAlert() { document.getElementById('alertModal').classList.add('hidden'); }

        function maskCelular(input) {
            let v = input.value.replace(/\D/g, "");
            if (v.length > 11) v = v.slice(0, 11);
            if (v.length > 10) v = v.replace(/^(\d{2})(\d{5})(\d{4}).*/, "($1) $2-$3");
            else if (v.length > 6) v = v.replace(/^(\d{2})(\d{4})(\d{0,4}).*/, "($1) $2-$3");
            else if (v.length > 2) v = v.replace(/^(\d{2})(\d{0,5}).*/, "($1) $2");
            else if (v.length > 0) v = v.replace(/^(\d*)/, "($1");
            input.value = v;
        }

        function sendWhatsApp() {
            const nome = document.getElementById('nome').value.trim();
            const celular = document.getElementById('celular').value.trim();
            const endereco = document.getElementById('endereco').value.trim();
            const pagamento = document.getElementById('pagamento').value;

            if (!nome || !celular || !endereco || !pagamento) {
                return showAlert("Por favor, preencha Nome, Celular, Endere√ßo e Pagamento.");
            }

            let msg = `*NOVO PEDIDO - BELLA MASSA*\n`;
            msg += `*Cliente:* ${nome}\n`;
            msg += `*Celular:* ${celular}\n`;
            msg += `*Endere√ßo:* ${endereco}\n`;
            msg += `*Pagamento:* ${pagamento}\n`;
            const obs = document.getElementById('obs').value.trim();
            if (obs) msg += `*Obs:* ${obs}\n`;

            msg += `\n*ITENS:*\n`;
            cart.forEach(item => {
                msg += `‚Ä¢ ${item.nome} ${item.borda ? '(Borda: ' + item.borda + ')' : ''}\n`;
            });

            const total = cart.reduce((acc, item) => acc + item.preco, 0);
            msg += `\n*TOTAL: R$ ${total.toFixed(2).replace('.', ',')}*`;

            window.open(`https://wa.me/5565992507339?text=${encodeURIComponent(msg)}`);
        }

        window.onload = renderMenu;
    </script>
</body>

</html>