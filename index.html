<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bella Massa - Card√°pio Digital</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="icon" type="image/png" href="./bellamassa.png">

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#000000',
                        brandBg: '#fef5e6',
                    }
                }
            }
        }
    </script>
    <style type="text/tailwindcss">
        @layer components {
            .btn-tab { @apply ml-4 mr-2 py-2 text-white font-bold transition-all border-b-2 border-transparent; }
            .btn-tab.active { @apply bg-white/20 border-black; }
            .modal-container { @apply fixed inset-0 bg-black/70 z-[1000] flex items-center justify-center hidden p-4; }
            .modal-content-center { 
                @apply bg-brandBg w-full max-w-md p-6 rounded-[2rem] max-h-[90vh] overflow-y-auto shadow-2xl animate-[popIn_0.2s_ease-out];
                scrollbar-width: none; 
                -ms-overflow-style: none; 
            }
            .modal-content-center::-webkit-scrollbar { display: none; }
            .flavor-card { @apply bg-white border-2 border-transparent p-4 rounded-xl text-center cursor-pointer shadow-sm font-semibold transition-all; }
            .flavor-card.selected { @apply border-primary bg-[#fde8e7] text-primary; }
            .modal-alert-content { @apply bg-white rounded-3xl p-8 w-full max-w-xs text-center shadow-2xl animate-[popIn_0.2s_ease-out]; }
        }
        @keyframes popIn { from { transform: scale(0.9); opacity: 0; } to { transform: scale(1); opacity: 1; } }
        @keyframes tabFadeIn {
            from { opacity: 0; transform: translateY(14px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .category-section.tab-enter { animation: tabFadeIn 0.35s ease-out forwards; }
        .btn-tab { transition: background 0.2s ease, border-color 0.2s ease, transform 0.15s ease; }
        .btn-tab.active { transform: scale(1.02); }
    </style>
</head>

<body class="bg-brandBg text-gray-800 pb-24">

    <div id="alertModal" class="modal-container" style="z-index: 3000;" onclick="closeAlert()">
        <div class="modal-alert-content" onclick="event.stopPropagation()">
            <div id="alertIcon" class="text-6xl mb-4"></div>
            <h3 id="alertTitle" class="text-2xl font-bold text-gray-800 mb-2"></h3>
            <p id="alertMessage" class="text-gray-600 mb-8 leading-relaxed"></p>
            <div id="alertButtons" class="space-y-2">
                <button id="alertBtnPrimary" onclick="closeAlert()"
                    class="w-full bg-primary text-white py-4 rounded-2xl font-bold uppercase shadow-lg active:scale-95">Entendido</button>
                <button id="alertBtnCart" onclick="showCart(); closeAlert();"
                    class="w-full bg-green-600 text-white py-4 rounded-2xl font-bold uppercase shadow-lg active:scale-95 hidden">Ver
                    Carrinho</button>
            </div>
        </div>
    </div>

    <header class="bg-white flex justify-between items-center shadow-md px-6 py-2">
        <img src="bellamassa.png" alt="Bella Massa" class="w-[120px] rounded-full">
        <div class=" relative cursor-pointer" onclick="showCart()">
            <i class="fas fa-shopping-cart text-primary text-2xl"></i>
            <span id="cartBadge"
                class="absolute -top-2 -right-2 bg-green-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center hidden font-bold">0</span>
        </div>
    </header>

    <nav class="tabs flex sticky top-0 z-50 bg-white border-t-2 shadow-lg font-sans">
        <button id="btn-pizzas" class="btn-tab active uppercase text-[14px] text-black tracking-tighter"
            onclick="openTab('pizzas')">Pizzas Salgadas</button>
        <!-- <button id="btn-doces" class="btn-tab uppercase text-[14px] tracking-tighter" onclick="openTab('doces')">Pizzas
            Doces</button> -->
        <button id="btn-bebidas" class="btn-tab uppercase text-black text-[14px] tracking-tighter"
            onclick="openTab('bebidas')">Bebidas</button>
    </nav>

    <main class="container max-w-xl mx-auto p-4">
        <div id="pizzas" class="category-section block space-y-4"></div>
        <div id="doces" class="category-section hidden space-y-4"></div>
        <div id="bebidas" class="category-section hidden space-y-4"></div>
    </main>

    <div id="selectionModal" class="modal-container" onclick="handleOutsideClick(event)">
        <div class="modal-content-center">
            <div id="step1">
                <div class="flex justify-between items-center mb-4">
                    <h2 id="modalTitle" class="text-xl font-bold text-primary italic">Sabores</h2>
                    <span id="stepBadge"
                        class="bg-primary/10 text-primary px-3 py-1 rounded-full text-[10px] font-bold">PASSO 1/2</span>
                </div>
                <div id="flavorContainer" class="space-y-2 mb-6"></div>
                <div class="flex gap-2">
                    <button class="flex-1 bg-gray-200 text-gray-500 py-3 rounded-xl font-bold uppercase text-xs"
                        onclick="closeModal('selectionModal')">Sair</button>
                    <button class="flex-1 bg-primary text-white py-3 rounded-xl font-bold uppercase text-xs shadow-md"
                        onclick="goToStep(2)">Pr√≥ximo</button>
                </div>
            </div>
            <div id="step2" class="hidden">
                <div class="flex justify-between items-center mb-4">
                    <h2 class="text-xl font-bold text-primary italic">Borda</h2>
                    <span class="bg-primary/10 text-primary px-3 py-1 rounded-full text-[10px] font-bold">PASSO
                        2/2</span>
                </div>
                <div id="bordaContainer" class="grid grid-cols-1 gap-2 mb-6"></div>
                <div class="flex gap-2">
                    <button
                        class="flex-1 bg-white border border-gray-200 text-gray-400 py-3 rounded-xl font-bold uppercase text-xs"
                        onclick="goToStep(1)">Voltar</button>
                    <button class="flex-1 bg-primary text-white py-3 rounded-xl font-bold uppercase text-xs shadow-md"
                        onclick="confirmSelection()">Concluir</button>
                </div>
            </div>
        </div>
    </div>

    <div id="cartModal" class="modal-container" onclick="handleOutsideClick(event)">
        <div class="modal-content-center">
            <div id="cartStep1">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-2xl font-bold text-primary italic">Seu Pedido</h2>
                    <button onclick="closeModal('cartModal')" class="text-gray-400"><i
                            class="fas fa-times text-xl"></i></button>
                </div>
                <div id="cartList" class="space-y-3 mb-6"></div>
                <div id="cartActions" class="flex gap-2 hidden">
                    <button class="flex-1 bg-gray-200 text-gray-500 py-4 rounded-2xl font-bold uppercase text-xs"
                        onclick="closeModal('cartModal')">Comprar +</button>
                    <button id="btnNextCart"
                        class="flex-1 bg-primary text-white py-4 rounded-2xl font-bold uppercase text-xs shadow-lg"
                        onclick="switchCartStep(2)">Finalizar</button>
                </div>
                <div id="emptyCartMsg" class="text-center py-10 hidden">
                    <i class="fas fa-shopping-basket text-gray-300 text-5xl mb-4"></i>
                    <p class="text-gray-400 font-semibold mb-6">Seu carrinho est√° vazio</p>
                </div>
            </div>

            <div id="cartStep2" class="hidden">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-2xl font-bold text-primary italic">Finalizar</h2>
                    <button onclick="switchCartStep(1)" class="text-gray-400"><i
                            class="fas fa-arrow-left text-xl"></i></button>
                </div>
                <div class="space-y-3 bg-white p-4 rounded-3xl border border-gray-100 shadow-inner mb-6">
                    <input type="text" id="nome" placeholder="Seu Nome"
                        class="w-full p-4 rounded-xl border border-gray-100 bg-gray-50 outline-primary text-sm">
                    <input type="tel" id="celular" placeholder="Seu Celular (Ex: (65) 99999-9999)"
                        class="w-full p-4 rounded-xl border border-gray-100 bg-gray-50 outline-primary text-sm"
                        oninput="maskCelular(this)" maxlength="15">
                    <input type="text" id="endereco" placeholder="Endere√ßo Completo"
                        class="w-full p-4 rounded-xl border border-gray-100 bg-gray-50 outline-primary text-sm">
                    <select id="pagamento"
                        class="w-full p-4 rounded-xl border border-gray-100 bg-gray-50 outline-primary text-sm">
                        <option value="" disabled selected>Forma de Pagamento</option>
                        <option value="Pix">Pix</option>
                        <option value="Cart√£o">Cart√£o</option>
                        <option value="Dinheiro">Dinheiro</option>
                    </select>
                    <textarea id="obs" placeholder="Alguma observa√ß√£o?"
                        class="w-full p-4 rounded-xl border border-gray-100 bg-gray-50 outline-primary text-sm h-20"></textarea>
                </div>
                <button
                    class="w-full bg-green-600 text-white py-4 rounded-2xl font-bold uppercase flex items-center justify-center gap-3 shadow-lg active:scale-95"
                    onclick="sendWhatsApp()">
                    <i class="fab fa-whatsapp text-xl"></i> Enviar Pedido
                </button>
            </div>
        </div>
    </div>

    <div class="fixed bottom-6 left-1/2 -translate-x-1/2 w-[92%] max-w-md bg-primary text-white p-4 rounded-[2rem] flex justify-between items-center font-bold shadow-2xl z-40 cursor-pointer active:scale-95 transition-transform"
        onclick="showCart()">
        <span class="flex items-center gap-2 uppercase text-xs tracking-wider ml-2"><i class="fas fa-shopping-bag"></i>
            Carrinho</span>
        <span id="totalDisplay" class="bg-white text-primary px-5 py-2 rounded-full font-black text-lg font-sans">R$
            0,00</span>
    </div>

    <script>
        const listaPizzas = [
            {
                id: 1,
                nome: "Combo 3 Pizzas",
                desc: "Escolha at√© 3 sabores",
                preco: 99.90,
                max: 3,
                borda: true,
                foto: "https://img.uenicdn.com/cdn-cgi/image/width=1024,fit=crop,f=auto/image/upload/v1544801901/category/shutterstock_571691737.jpg"
            },
            {
                id: 2,
                nome: "Combo 2 Pizzas",
                desc: "Escolha at√© 2 sabores",
                preco: 79.90,
                max: 2,
                borda: true,
                foto: "https://s3.us-west-2.amazonaws.com/whatsmenu/production/pizzariahamburgueriameatsvespasiano/products/494508/t2pizzajpg"
            },
            {
                id: 5,
                nome: "Pizza Tradicional",
                desc: "Pizza Inteira Salgada",
                preco: 44.90,
                max: 2,
                borda: true,
                foto: "https://swiftbr.vteximg.com.br/arquivos/ids/213885-636-636/618283-pizza-artesanal-calabresa_inn.jpg?v=639051131497770000"
            }
        ];


        const listaDoces = [
            {
                id: 201,
                nome: "Pizza Chocolate",
                desc: "Chocolate ao leite",
                preco: 45.90,
                foto: "https://instagram.fcgb1-1.fna.fbcdn.net/v/t39.30808-6/435693923_18418922071048582_4461348753245569872_n.jpg?stp=dst-jpg_e35_tt6&_nc_cat=111&ig_cache_key=MzMzOTAyMzMyMjQ1NDk1NDc5Ng%3D%3D.3-ccb7-5&ccb=7-5&_nc_sid=58cdad&efg=eyJ2ZW5jb2RlX3RhZyI6InhwaWRzLjE0NDB4OTU5LnNkci5DMyJ9&_nc_ohc=cCilaQPKcyEQ7kNvwGTgJpR&_nc_oc=AdnVu0_VKZ45NZ9T5UbJKmiTdLEfyo4A2BzaRlgD42F8TnD_DT6CxBhvmvUXP5jUVs-NLDxCG3XXmTDpzjr55J6E&_nc_ad=z-m&_nc_cid=0&_nc_zt=23&_nc_ht=instagram.fcgb1-1.fna&_nc_gid=VPnOvX1AutAnU5i4H1Zi3Q&oh=00_Afv8WtgNaVRdXTVPmgbc3hCHZKF6F-kMnl-d3Yx6Bb0wAw&oe=699BA267"
            },
            {
                id: 202,
                nome: "Pizza Prest√≠gio",
                desc: "Chocolate com coco",
                preco: 45.90,
                foto: "https://instagram.fcgb1-1.fna.fbcdn.net/v/t51.75761-15/482910789_18073110325783580_361274072064261522_n.jpg?stp=dst-jpg_e35_tt6&_nc_cat=111&ig_cache_key=MzU4MjUyMTczNzI5ODIyNjk0MA%3D%3D.3-ccb7-5&ccb=7-5&_nc_sid=58cdad&efg=eyJ2ZW5jb2RlX3RhZyI6InhwaWRzLjExNzl4MTE3OS5zZHIuQzMifQ%3D%3D&_nc_ohc=4uyhmiVuQFIQ7kNvwE7KsJu&_nc_oc=AdnQTxWvQNpp_uxahC-a61uKfHG2S3YV8-SsGPDU9IJJbysOn1pkJtUpk9L6PE5LmeVNEtBlqKLQdawGwT7spYGt&_nc_ad=z-m&_nc_cid=0&_nc_zt=23&_nc_ht=instagram.fcgb1-1.fna&_nc_gid=qBaEi_q13EtVyBnm1Mj05g&oh=00_Aft6gMZU49uQDjNwzFjolic_oFPpqR-DzJZqc46Rdn1e6A&oe=699B7877"
            },
            {
                id: 203,
                nome: "Pizza Romeu e Julieta",
                desc: "Queijo com goiabada",
                preco: 45.90,
                foto: "https://beatoven.com.br/wp-content/uploads/2024/11/sq-romeu-e-julieta.jpg"
            },
            {
                id: 204,
                nome: "Pizza Banana c/ Canela",
                desc: "Banana e a√ß√∫car",
                preco: 45.90,
                foto: "https://instagram.fcgb1-1.fna.fbcdn.net/v/t39.30808-6/494198820_1276102007857951_6511198047695237086_n.jpg?stp=dst-jpg_e35_tt6&_nc_cat=107&ig_cache_key=MzUwMTM2MzQwNTcxNTA0MTU3NA%3D%3D.3-ccb7-5&ccb=7-5&_nc_sid=58cdad&efg=eyJ2ZW5jb2RlX3RhZyI6InhwaWRzLjIwNDh4MjA0OC5zZHIuQzMifQ%3D%3D&_nc_ohc=pwSfVy8_KqQQ7kNvwH8XiQR&_nc_oc=AdlrlEq_Yd6d5YgF8LV2V_now3gh5aOsKiGg5fH0WpEfrycPI_Dkl8-QVY4CadVbgcxeEPjLmoWjS9zMW1EE6yVK&_nc_ad=z-m&_nc_cid=0&_nc_zt=23&_nc_ht=instagram.fcgb1-1.fna&_nc_gid=7JdmDFen0NHQaPzYm11IGQ&oh=00_AfsvrM7RTTUf8FPJ16u9siDGrHioxeVGDrwtNrqlLggOfQ&oe=699B9786"
            }
        ];


        const listaBebidas = [
            {
                id: 101,
                nome: "Coca-Cola 2L",
                desc: "Geladinha",
                preco: 14.00,
                foto: "https://swiftbr.vteximg.com.br/arquivos/ids/208244-636-636/622530-coca-cola-garrafa_mck.jpg?v=638862948323200000"
            },
            {
                id: 102,
                nome: "Kitubaiana 2L",
                desc: "Maraja ",
                preco: 12.00,
                foto: "https://marajarefrigerantes.com.br/storage/2022/11/Kitunaina-2L.png"
            },
            {
                id: 104,
                nome: "Coca-Cola Lata",
                desc: "350ml",
                preco: 6.00,
                foto: "https://swiftbr.vteximg.com.br/arquivos/ids/212288-636-636/622532-coca-cola-lata_mck.jpg?v=638995819113070000"
            }
        ];

        const listaBordas = [
            'Sem Borda',
            'Catupiry',
            'Cheddar',
            'Creme de Alho'
        ];


        const saboresSalgados = [
            {
                nome: "Mussarela",
                desc: "Molho de tomate, mussarela e or√©gano",
                foto: "https://swiftbr.vteximg.com.br/arquivos/ids/207855-636-636/618284-pizza-artesanal-de-mussarela_rec.jpg?v=638851842154900000"
            },
            {
                nome: "Calabresa",
                desc: "Molho de tomate, mussarela, calabresa fatiada, cebola e or√©gano",
                foto: "https://cantinagiovannifreddo.com.br/wp-content/uploads/2023/09/PIZZA-DE-CALABRESA.webp"
            },
            {
                nome: "Mista",
                desc: "Molho de tomate, mussarela, presunto, bacon, milho e or√©gano",
                foto: "https://www.pizzariaatlantico.com.br/img/produtos/22-07-18-11-pizza-de-presunto-01.jpg"
            },
            {
                nome: "Frango com Catupiry",
                desc: "Molho de tomate, mussarela, frango desfiado temperado e requeij√£o tipo catupiry",
                foto: "https://cantinagiovannifreddo.com.br/wp-content/uploads/2024/10/37f450b2-9115-415b-93ce-e484421ce3d5-800x841.jpg"
            },
            {
                nome: "Portuguesa",
                desc: "Molho de tomate, mussarela, presunto, ovo, cebola e azeitona",
                foto: "https://www.ogastronomo.com.br/upload/389528334-curiosidades-sobre-a-pizza-portuguesa.jpg"
            },
            {
                nome: "Quatro Queijos",
                desc: "Molho de tomate, mussarela, requeij√£o, parmes√£o ralado e provolone",
                foto: "https://www.receitasnestle.com.br/sites/default/files/styles/recipe_detail_desktop_new/public/srh_recipes/d036cd01122da62bf581784f52d99b3a.jpg?itok=rLpIJBbu"
            },
            {
                nome: "Bacon",
                desc: "Molho de tomate, mussarela e bacon em cubos crocante",
                foto: "https://www.seara.com.br/wp-content/uploads/2025/09/R0524_SL_pizza_de_bacon_com_requeijao-1200x675-1.webp"
            },
            {
                nome: "Moda da Casa",
                desc: "Molho de tomate, mussarela, calabresa, bacon fatiado, cebola e piment√£o",
                foto: "https://i.ytimg.com/vi/Pv7LsXAoAv8/maxresdefault.jpg"
            }
        ];




        let cart = [];
        let currentTask = { max: 0, name: '', price: 0, selectedBorda: 'Sem Borda', hasBorda: true };
        let flavorSelections = {};

        function renderBordas() {
            document.getElementById('bordaContainer').innerHTML = listaBordas.map(b => `
                <div class="flavor-card borda-opt" onclick="selectBorda(this, '${b}')">${b}</div>
            `).join('');
        }

        function renderMenu() {
            renderBordas();
            document.getElementById('pizzas').innerHTML = listaPizzas.map(p => `
                <div class="product-card bg-white p-4 rounded-xl flex items-center gap-3 shadow-sm">
                    <img src="${p.foto}" alt="${p.nome}" class="w-20 h-20 rounded-2xl object-cover flex-shrink-0">
                    <div class="flex-1">
                        <h3 class="font-bold text-primary text-lg">${p.nome}</h3>
                        <p class="text-sm text-gray-500 italic">${p.desc}</p>
                        <span class="font-bold text-xl text-primary font-sans">R$ ${p.preco.toFixed(2).replace('.', ',')}</span>
                    </div>
                    <button class="bg-primary text-white w-12 h-12 rounded-full text-2xl flex items-center justify-center shadow-lg font-bold"
                        onclick="openSelectionModal(${p.max}, '${p.nome}', ${p.preco}, ${p.borda})">+</button>
                </div>`).join('');

            // document.getElementById('doces').innerHTML = listaDoces.map(d => `
            //     <div class="product-card bg-white p-4 rounded-xl flex items-center gap-3 shadow-sm">
            //         <img src="${d.foto}" alt="${d.nome}" class="w-20 h-20 rounded-2xl object-cover flex-shrink-0">
            //         <div class="flex-1">
            //             <h3 class="font-bold text-primary text-lg">${d.nome}</h3>
            //             <p class="text-sm text-gray-500 italic">${d.desc}</p>
            //             <span class="font-bold text-xl text-primary font-sans">R$ ${d.preco.toFixed(2).replace('.', ',')}</span>
            //         </div>
            //         <button class="bg-primary text-white w-12 h-12 rounded-full text-2xl flex items-center justify-center shadow-lg active:scale-90 font-bold"
            //             onclick="addToCart('${d.nome}', ${d.preco})">+</button>
            //     </div>`).join('');

            document.getElementById('bebidas').innerHTML = listaBebidas.map(b => `
                <div class="product-card bg-white p-4 rounded-xl flex items-center gap-3 shadow-sm">
                    <img src="${b.foto}" alt="${b.nome}" class="w-16 h-16 rounded-2xl object-cover flex-shrink-0">
                    <div class="flex-1">
                        <h3 class="font-bold text-primary text-lg">${b.nome}</h3>
                        <p class="text-sm text-gray-500 italic">${b.desc}</p>
                        <span class="font-bold text-xl text-primary font-sans">R$ ${b.preco.toFixed(2).replace('.', ',')}</span>
                    </div>
                    <button class="bg-primary text-white w-12 h-12 rounded-full text-2xl flex items-center justify-center shadow-lg active:scale-90 font-bold"
                        onclick="addToCart('${b.nome}', ${b.preco})">+</button>
                </div>`).join('');
        }

        function openTab(id) {
            document.querySelectorAll('.category-section').forEach(s => {
                s.classList.add('hidden');
                s.classList.remove('block', 'tab-enter');
            });
            document.querySelectorAll('.btn-tab').forEach(b => b.classList.remove('active'));
            const target = document.getElementById(id);
            target.classList.remove('hidden');
            target.classList.add('block', 'tab-enter');
            document.getElementById('btn-' + id).classList.add('active');
            target.addEventListener('animationend', function onEnd() {
                target.classList.remove('tab-enter');
                target.removeEventListener('animationend', onEnd);
            }, { once: true });
        }

        function openSelectionModal(max, name, price, hasBorda) {
            currentTask = { max, name, price, selectedBorda: 'Sem Borda', hasBorda };
            flavorSelections = {};
            saboresSalgados.forEach(s => flavorSelections[s.nome] = 0);
            document.getElementById('modalTitle').innerText = name;
            document.getElementById('stepBadge').innerText = "PASSO 1/2";
            renderFlavorSteps();
            goToStep(1);
            document.getElementById('selectionModal').classList.remove('hidden');
            document.getElementById('selectionModal').classList.add('flex');
        }

        function renderFlavorSteps() {
            document.getElementById('flavorContainer').innerHTML = saboresSalgados.map(s => `
                <div class="flex items-center justify-between bg-white p-3 rounded-xl border border-gray-100 shadow-sm gap-3">
                    <img src="${s.foto}" alt="${s.nome}" class="w-14 h-14 rounded-xl object-cover flex-shrink-0">
                    <div class="flex-1 pr-2">
                        <span class="font-bold text-gray-700 text-sm font-sans block">${s.nome}</span>
                        <small class="text-[14px] text-gray-400 leading-tight block">${s.desc}</small>
                    </div>
                    <div class="flex items-center gap-3 bg-gray-50 rounded-full px-2 py-1">
                        <button onclick="changeFlavorQty('${s.nome}', -1)" class="w-8 h-8 bg-white rounded-full shadow text-primary font-black text-lg">-</button>
                        <span id="qty-${s.nome}" class="font-bold min-w-[15px] text-center text-sm font-sans">0</span>
                        <button onclick="changeFlavorQty('${s.nome}', 1)" class="w-8 h-8 bg-white rounded-full shadow text-primary font-black text-lg">+</button>
                    </div>
                </div>`).join('');
        }

        function changeFlavorQty(sabor, delta) {
            const totalSelected = Object.values(flavorSelections).reduce((a, b) => a + b, 0);
            if (delta > 0 && totalSelected >= currentTask.max) return showAlert(`Limite de ${currentTask.max} sabores atingido.`);
            if (delta < 0 && flavorSelections[sabor] <= 0) return;
            flavorSelections[sabor] += delta;
            document.getElementById(`qty-${sabor}`).innerText = flavorSelections[sabor];
            document.getElementById('modalSubtitle').innerText = `Selecionado: ${totalSelected + delta} de ${currentTask.max}`;
        }

        function goToStep(step) {
            if (step === 2) {
                const total = Object.values(flavorSelections).reduce((a, b) => a + b, 0);
                if (total !== currentTask.max) return showAlert(`Por favor, selecione os ${currentTask.max} sabores.`);
                document.getElementById('step1').classList.add('hidden');
                document.getElementById('step2').classList.remove('hidden');
            } else {
                document.getElementById('step1').classList.remove('hidden');
                document.getElementById('step2').classList.add('hidden');
            }
        }

        function selectBorda(element, borda) {
            document.querySelectorAll('.borda-opt').forEach(el => el.classList.remove('selected'));
            element.classList.add('selected');
            currentTask.selectedBorda = borda;
        }

        function confirmSelection() {
            const flavorsArray = [];
            for (const [sabor, qtd] of Object.entries(flavorSelections)) { if (qtd > 0) flavorsArray.push(`${qtd}x ${sabor}`); }
            cart.push({ nome: `${currentTask.name} (${flavorsArray.join(' + ')})`, borda: currentTask.selectedBorda, preco: currentTask.price });
            updateUI();
            closeModal('selectionModal');
            showAlert('Produto adicionado ao carrinho!', 'success');
        }

        function addToCart(name, price) {
            cart.push({ nome: name, preco: price, borda: '' });
            updateUI();
            showAlert('Produto adicionado ao carrinho!', 'success');
        }

        function updateUI() {
            const total = cart.reduce((acc, item) => acc + item.preco, 0);
            document.getElementById('totalDisplay').innerText = `R$ ${total.toFixed(2).replace('.', ',')}`;
            const badge = document.getElementById('cartBadge');
            badge.innerText = cart.length;
            cart.length > 0 ? badge.classList.remove('hidden') : badge.classList.add('hidden');
        }

        function switchCartStep(step) {
            if (step === 2 && cart.length === 0) return;
            document.getElementById('cartStep1').classList.toggle('hidden', step === 2);
            document.getElementById('cartStep2').classList.toggle('hidden', step === 1);
        }

        function showCart() {
            const list = document.getElementById('cartList');
            const actions = document.getElementById('cartActions');
            const emptyMsg = document.getElementById('emptyCartMsg');
            switchCartStep(1);
            if (cart.length === 0) {
                list.innerHTML = "";
                actions.classList.add('hidden');
                emptyMsg.classList.remove('hidden');
            } else {
                emptyMsg.classList.add('hidden');
                actions.classList.remove('hidden');
                list.innerHTML = cart.map((item, i) => `
                <div class="flex justify-between items-center bg-white p-4 rounded-2xl border border-gray-100 shadow-sm">
                    <div><b class="text-primary text-sm uppercase block">${item.nome}</b>
                    ${item.borda ? `<small class="text-gray-400 font-bold text-[10px]">Borda: ${item.borda}</small>` : ''}</div>
                    <div class="text-right ml-4"><b class="block text-primary text-sm font-sans">R$ ${item.preco.toFixed(2).replace('.', ',')}</b>
                    <button onclick="removeItem(${i})" class="text-red-400 text-[10px] font-black uppercase">Remover</button></div>
                </div>`).join('');
            }
            document.getElementById('cartModal').classList.remove('hidden');
            document.getElementById('cartModal').classList.add('flex');
        }

        function removeItem(i) { cart.splice(i, 1); updateUI(); showCart(); }
        function closeModal(id) { document.getElementById(id).classList.add('hidden'); }
        function handleOutsideClick(event) { if (event.target.classList.contains('modal-container')) closeModal(event.target.id); }

        function showAlert(message, type = 'error') {
            document.getElementById('alertIcon').innerHTML = type === 'success' ? '‚ú®' : 'üîî';
            document.getElementById('alertTitle').innerText = type === 'success' ? 'Sucesso!' : 'Aten√ß√£o';
            document.getElementById('alertMessage').innerText = message;
            const btnPrimary = document.getElementById('alertBtnPrimary');
            const btnCart = document.getElementById('alertBtnCart');
            if (type === 'success') {
                btnPrimary.innerText = "Continuar";
                btnCart.classList.remove('hidden');
            } else {
                btnPrimary.innerText = "Entendido";
                btnCart.classList.add('hidden');
            }
            document.getElementById('alertModal').classList.remove('hidden');
            document.getElementById('alertModal').classList.add('flex');
        }
        function closeAlert() { document.getElementById('alertModal').classList.add('hidden'); }

        function maskCelular(input) {
            let v = input.value.replace(/\D/g, "");
            if (v.length > 11) v = v.slice(0, 11);
            if (v.length > 10) v = v.replace(/^(\d{2})(\d{5})(\d{4}).*/, "($1) $2-$3");
            else if (v.length > 6) v = v.replace(/^(\d{2})(\d{4})(\d{0,4}).*/, "($1) $2-$3");
            else if (v.length > 2) v = v.replace(/^(\d{2})(\d{0,5}).*/, "($1) $2");
            else if (v.length > 0) v = v.replace(/^(\d*)/, "($1");
            input.value = v;
        }

        function sendWhatsApp() {
            const nome = document.getElementById('nome').value.trim();
            const celular = document.getElementById('celular').value.trim();
            const endereco = document.getElementById('endereco').value.trim();
            const pagamento = document.getElementById('pagamento').value;

            if (!nome || !celular || !endereco || !pagamento) {
                return showAlert("Por favor, preencha Nome, Celular, Endere√ßo e Pagamento.");
            }

            let msg = `*NOVO PEDIDO - BELLA MASSA*\n`;
            msg += `*Cliente:* ${nome}\n`;
            msg += `*Celular:* ${celular}\n`;
            msg += `*Endere√ßo:* ${endereco}\n`;
            msg += `*Pagamento:* ${pagamento}\n`;
            const obs = document.getElementById('obs').value.trim();
            if (obs) msg += `*Obs:* ${obs}\n`;

            msg += `\n*ITENS:*\n`;
            cart.forEach(item => {
                msg += `‚Ä¢ ${item.nome} ${item.borda ? '(Borda: ' + item.borda + ')' : ''}\n`;
            });

            const total = cart.reduce((acc, item) => acc + item.preco, 0);
            msg += `\n*TOTAL: R$ ${total.toFixed(2).replace('.', ',')}*`;

            window.open(`https://wa.me/5565992507339?text=${encodeURIComponent(msg)}`);
        }

        window.onload = renderMenu;
    </script>
    <!-- Meta Pixel Code -->
    <script>
        !function (f, b, e, v, n, t, s) {
            if (f.fbq) return; n = f.fbq = function () {
                n.callMethod ?
                    n.callMethod.apply(n, arguments) : n.queue.push(arguments)
            };
            if (!f._fbq) f._fbq = n;
            n.push = n; n.loaded = !0; n.version = '2.0';
            n.queue = [];
            t = b.createElement(e); t.async = !0;
            t.src = v;
            s = b.getElementsByTagName(e)[0];
            s.parentNode.insertBefore(t, s)
        }
            (window, document, 'script',
                'https://connect.facebook.net/en_US/fbevents.js');

        fbq('init', '784923854077490');
        fbq('track', 'PageView');
    </script>

    <noscript>
        <img height="1" width="1" style="display:none"
            src="https://www.facebook.com/tr?id=SEU_PIXEL_ID_AQUI&ev=PageView&noscript=1" />
    </noscript>
    <!-- End Meta Pixel Code -->

</body>

</html>